package org.exploit.tss.frost.secp256k1;

import org.exploit.gmp.BigInt;
import org.exploit.secp256k1.Secp256k1PointOps;
import org.exploit.tss.frost.ciphersuite.FrostCipherSuite;
import org.exploit.tss.frost.model.ContextOfR;
import org.exploit.tss.frost.schema.DefaultFrostScheme;
import org.exploit.tss.frost.secp256k1.ciphersuite.FrostSecp256k1Sha256V1CipherSuite;
import org.exploit.tss.signature.Sec1RSchnorrSignature;

public class FrostSecp256k1Scheme extends DefaultFrostScheme<Secp256k1PointOps> {
    @Override
    public Sec1RSchnorrSignature buildSignature(ContextOfR<Secp256k1PointOps> context, BigInt s, BigInt q) {
        var r33 = context.canon().encode(true);
        var s32 = s.mod(q).toUnsignedByteArray(32);

        return new Sec1RSchnorrSignature(r33, s32);
    }

    @Override
    protected FrostCipherSuite<Secp256k1PointOps> cipherSuite() {
        return new FrostSecp256k1Sha256V1CipherSuite();
    }
}
