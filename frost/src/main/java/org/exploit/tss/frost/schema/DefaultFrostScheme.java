package org.exploit.tss.frost.schema;

import org.exploit.gmp.BigInt;
import org.exploit.tss.curve.PointOps;
import org.exploit.tss.frost.ciphersuite.FrostCipherSuite;
import org.exploit.tss.frost.model.ContextOfR;
import org.exploit.tss.frost.model.ParticipantCommitment;

import java.util.List;

public abstract class DefaultFrostScheme<P extends PointOps<P>> implements FrostScheme<P> {
    protected abstract FrostCipherSuite<P> cipherSuite();

    @Override
    public byte[] prepareMessage(byte[] msg) {
        return msg;
    }

    @Override
    public BigInt h1(int idx, byte[] msgPrepared, List<ParticipantCommitment<P>> B, BigInt q) {
        return cipherSuite().h1(idx, msgPrepared, B, q);
    }

    @Override
    public ContextOfR<P> computeRCtx(P raw) {
        return new ContextOfR<>(raw.normalize(), false);
    }

    @Override
    public BigInt h2(ContextOfR<P> rCtx, P Y, byte[] msgPrepared, BigInt q) {
        return cipherSuite().h2(rCtx.canon(), Y, msgPrepared, q);
    }
}
