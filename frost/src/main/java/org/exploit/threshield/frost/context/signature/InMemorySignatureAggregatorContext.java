package org.exploit.threshield.frost.context.signature;

import com.google.common.collect.HashBasedTable;
import com.google.common.collect.Table;
import com.google.common.collect.Tables;
import org.exploit.threshield.util.Sum;

import java.math.BigInteger;

public class InMemorySignatureAggregatorContext implements SignatureAggregatorContext {
    private final Table<Integer, String, BigInteger> peerZ = Tables.synchronizedTable(HashBasedTable.create());

    @Override
    public void storeZ(int idx, String opId, BigInteger z) {
        peerZ.put(idx, opId, z);
    }

    @Override
    public BigInteger sumZ(String opId, BigInteger q) {
        return Sum.modSum(BigInteger.ZERO, q, peerZ.column(opId).values());
    }
}
