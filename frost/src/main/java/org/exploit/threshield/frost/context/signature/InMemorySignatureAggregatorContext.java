package org.exploit.threshield.frost.context.signature;

import com.google.common.collect.HashBasedTable;
import com.google.common.collect.Table;
import com.google.common.collect.Tables;
import org.exploit.gmp.BigInt;
import org.exploit.threshield.util.Sum;

public class InMemorySignatureAggregatorContext implements SignatureAggregatorContext {
    private final Table<Integer, String, BigInt> peerZ = Tables.synchronizedTable(HashBasedTable.create());

    @Override
    public void storeZ(int idx, String opId, BigInt z) {
        peerZ.put(idx, opId, z);
    }

    @Override
    public BigInt sumZ(String opId, BigInt q) {
        return Sum.modSum(BigInt.ZERO, q, peerZ.column(opId).values());
    }
}
