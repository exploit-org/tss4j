package org.exploit.threshield.frost.context.crypto;

import lombok.AllArgsConstructor;
import lombok.Builder;
import org.exploit.threshield.curve.EllipticCurveParams;
import org.exploit.threshield.curve.PointOps;
import org.exploit.threshield.sodium.SecretBox;

import java.util.List;
import java.util.function.Supplier;

@Builder(builderMethodName = "newBuilder")
@AllArgsConstructor
public class InMemoryCryptoContext<P extends PointOps<P>> implements CryptoContext<P> {
    private final int idx;
    private final List<Integer> participants;
    private final EllipticCurveParams<P> curve;
    private final SecretBox ski;
    private final PointOps<P> Y;
    private final Supplier<byte[]> memKey;

    @Override
    public int idx() {
        return idx;
    }

    @Override
    public List<Integer> participants() {
        return participants;
    }

    @Override
    public SecretBox ski() {
        return ski;
    }

    @Override
    public Supplier<byte[]> memKey() {
        return memKey;
    }

    @Override
    public EllipticCurveParams<P> curve() {
        return curve;
    }

    @Override
    public PointOps<P> Y() {
        return Y;
    }
}
