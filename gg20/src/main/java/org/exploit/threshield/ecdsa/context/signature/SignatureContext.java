package org.exploit.threshield.ecdsa.context.signature;

import org.exploit.gmp.BigInt;
import org.exploit.threshield.curve.ec.WeierstrassPointOps;

public interface SignatureContext<P extends WeierstrassPointOps<P>> {
    void storeGamma(int peerId, WeierstrassPointOps<P> gamma);

    void storeDeltaShare(int peerId, BigInt deltaShare);

    WeierstrassPointOps<P> computeGammaProduct(WeierstrassPointOps<P> clientGamma);

    BigInt computeDeltaSum(BigInt deltaShare, BigInt q);

    static <P extends WeierstrassPointOps<P>> SignatureContext<P> inMemory() {
        return new InMemorySignatureContext<>();
    }
}
