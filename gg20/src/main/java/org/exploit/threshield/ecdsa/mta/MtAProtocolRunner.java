package org.exploit.threshield.ecdsa.mta;

import org.exploit.threshield.curve.ec.WeierstrassPointOps;
import org.exploit.threshield.ecdsa.context.GG20Context;
import org.exploit.threshield.mta.MtAProtocol;
import org.exploit.threshield.pallier.Paillier;

public class MtAProtocolRunner<P extends WeierstrassPointOps<P>> {
    private final MtAProtocol mta;
    private final MtAInitiatorProtocolRunner<P> initiator;
    private final MtARespondentProtocolRunner<P> respondent;

    public MtAProtocolRunner(GG20Context<P> context) {
        this.mta = new MtAProtocol(new Paillier(context.crypto().paillier()), context.crypto().curve().getCurveOrder());
        this.respondent = new MtARespondentProtocolRunner<>(mta, context);
        this.initiator = new MtAInitiatorProtocolRunner<>(mta, context);
    }

    public void init() {
        initiator.generateInitiatorMessage();
    }

    public MtAInitiatorProtocolRunner<P> asInitiator() {
        return initiator;
    }

    public MtARespondentProtocolRunner<P> asRespondent() {
        return respondent;
    }

    public MtAProtocol raw() {
        return mta;
    }
}
