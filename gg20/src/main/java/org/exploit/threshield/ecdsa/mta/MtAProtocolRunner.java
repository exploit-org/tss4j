package org.exploit.threshield.ecdsa.mta;

import org.exploit.threshield.ecdsa.context.GG20Context;
import org.exploit.zktrust.cipher.Paillier;
import org.exploit.zktrust.mta.MtAProtocol;

public class MtAProtocolRunner {
    private final MtAProtocol mta;
    private final MtAInitiatorProtocolRunner initiator;
    private final MtARespondentProtocolRunner respondent;

    public MtAProtocolRunner(GG20Context context) {
        this.mta = new MtAProtocol(new Paillier(context.crypto().paillier()), context.crypto().curve().getCurveOrder());
        this.respondent = new MtARespondentProtocolRunner(mta, context);
        this.initiator = new MtAInitiatorProtocolRunner(mta, context);
    }

    public void init() {
        initiator.generateInitiatorMessage();
    }

    public MtAInitiatorProtocolRunner asInitiator() {
        return initiator;
    }

    public MtARespondentProtocolRunner asRespondent() {
        return respondent;
    }

    public MtAProtocol raw() {
        return mta;
    }
}
