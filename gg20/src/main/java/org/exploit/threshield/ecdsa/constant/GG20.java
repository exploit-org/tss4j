package org.exploit.threshield.ecdsa.constant;

import org.bouncycastle.jce.ECNamedCurveTable;
import org.exploit.threshield.ecdsa.generator.GG20CommitmentGenerator;

import java.math.BigInteger;
import java.security.SecureRandom;

public final class GG20 {
    private GG20() {}

    public static class CommitmentGenerator {
        public static final GG20CommitmentGenerator SECP256k1;

        static {
            var ecSpec = ECNamedCurveTable.getParameterSpec("secp256k1");

            var q = ecSpec.getN();
            var g = ecSpec.getG();

            var scalar = new BigInteger(q.bitLength(), new SecureRandom()).mod(q);
            var h = g.multiply(scalar).normalize();

            SECP256k1 = new GG20CommitmentGenerator(q, g, h);
        }
    }

    public enum ComputationType {
        GAMMA,
        LAGRANGE
    }
}