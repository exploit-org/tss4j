package org.exploit.tss.ecdsa.context.crypto;

import org.exploit.tss.context.ShamirKeyContext;
import org.exploit.tss.curve.ec.WeierstrassCurveParams;
import org.exploit.tss.curve.ec.WeierstrassPointOps;
import org.exploit.tss.ecdsa.generator.CommitmentResult;
import org.exploit.tss.pallier.key.PaillierKeyPair;
import org.exploit.tss.proof.model.ZKSetup;

public interface CryptoContext<P extends WeierstrassPointOps<P>> extends ShamirKeyContext<P> {
    @Override
    WeierstrassCurveParams<P> curve();

    PaillierKeyPair paillier();

    WeierstrassPointOps<P> publicKey();

    CommitmentResult<P> ephemeral();

    ZKSetup zkSetup();

    void setCommitment(CommitmentResult<P> commitment);

    boolean isInitialized();

    @SuppressWarnings("unused")
    static <P extends WeierstrassPointOps<P>> InMemoryCryptoContext.Builder<P> inMemoryBuilder(Class<P> clazz) {
        return InMemoryCryptoContext.newBuilder();
    }
}
