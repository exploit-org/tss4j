package org.exploit.tss.signature;

import lombok.Getter;

@Getter
public class Sec1RSchnorrSignature implements Signature {
    private final byte[] r;
    private final byte[] s;

    public Sec1RSchnorrSignature(byte[] r, byte[] s) {
        if (r.length != 33)
            throw new IllegalArgumentException("R must be SEC1 encoded (33 bytes long)");

        int prefix = r[0] & 0xFF;
        if (prefix != 0x02 && prefix != 0x03)
            throw new IllegalArgumentException("R must be SEC1-compressed (prefix 0x02 or 0x03)");

        if (s.length != 32)
            throw new IllegalArgumentException("S must be 32 bytes long");

        this.r = r;
        this.s = s;
    }

    @Override
    public byte[] encode() {
        byte[] encoded = new byte[r.length + s.length];
        System.arraycopy(r, 0, encoded, 0, r.length);
        System.arraycopy(s, 0, encoded, r.length, s.length);
        return encoded;
    }
}
