package org.exploit.tss.signature;

import lombok.Getter;

import java.util.Objects;

@Getter
public class SchnorrSignature implements Signature {
    private final byte[] r;
    private final byte[] s;

    public SchnorrSignature(byte[] r, byte[] s) {
        if (Objects.requireNonNull(r).length != 32) {
            throw new IllegalArgumentException("r must be 32 bytes long");
        }

        if (Objects.requireNonNull(s).length != 32) {
            throw new IllegalArgumentException("s must be 32 bytes long");
        }

        this.r = r;
        this.s = s;
    }

    @Override
    public byte[] encode() {
        byte[] encoded = new byte[r.length + s.length];
        System.arraycopy(r, 0, encoded, 0, r.length);
        System.arraycopy(s, 0, encoded, r.length, s.length);
        return encoded;
    }
}
