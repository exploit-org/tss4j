package org.exploit.tss.util;

import org.exploit.gmp.BigInt;

import java.security.SecureRandom;

public final class BigIntUtils {
    private BigIntUtils() {}

    public static boolean isCoprime(BigInt x, BigInt n) {
        return x.gcd(n).equals(BigInt.ONE);
    }

    public static BigInt randomZnStar(BigInt n, SecureRandom rnd) {
        BigInt x;
        do {
            x = new BigInt(n.bitLength(), rnd).mod(n);
        } while (!isCoprime(x, n) || x.signum() == 0);
        return x;
    }
}