package org.exploit.threshield.curve.jce;

import lombok.AllArgsConstructor;
import org.bouncycastle.asn1.x9.X9ECParameters;
import org.exploit.threshield.curve.EllipticCurveParams;

import java.math.BigInteger;

@AllArgsConstructor
public class ECCurveParams implements EllipticCurveParams<ECPointOps> {
    private final X9ECParameters parameters;

    @Override
    public ECPointOps getG() {
        return new ECPointOps(parameters.getG());
    }

    @Override
    public BigInteger getCurveOrder() {
        return parameters.getN();
    }

    @Override
    public ECPointOps getInfinity() {
        return new ECPointOps(parameters.getCurve().getInfinity());
    }

    public X9ECParameters getX9ECParameters() {
        return parameters;
    }

    @Override
    public ECPointOps createPoint(BigInteger x, BigInteger y) {
        return new ECPointOps(parameters.getCurve().createPoint(x, y));
    }
}
