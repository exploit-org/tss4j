package org.exploit.threshield.proof.model;

import org.exploit.gmp.BigInt;
import org.exploit.gmp.util.PrimeNumberGenerator;
import org.exploit.threshield.util.ZKRandom;

public record ZKSetup(BigInt hatN, BigInt h1, BigInt h2) {
    public static ZKSetup generate(int bitLength) {
        var p = PrimeNumberGenerator.generate(bitLength / 2);
        var q = PrimeNumberGenerator.generate(bitLength / 2);

        var hatN = p.multiply(q);

        var h1 = new BigInt(hatN.bitLength(), ZKRandom.getRandom()).mod(hatN);
        var h2 = new BigInt(hatN.bitLength(), ZKRandom.getRandom()).mod(hatN);

        return new ZKSetup(hatN, h1, h2);
    }
}