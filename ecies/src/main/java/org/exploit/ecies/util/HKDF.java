package org.exploit.ecies.util;

import org.bouncycastle.crypto.digests.SHA384Digest;
import org.bouncycastle.crypto.generators.HKDFBytesGenerator;
import org.bouncycastle.crypto.params.HKDFParameters;
import org.exploit.tss.util.Bytes;

public final class HKDF {
    private HKDF() {}

    public static byte[] hkdf(byte[] s, byte[] r) {
        var hk = new HKDFBytesGenerator(new SHA384Digest());
        hk.init(new HKDFParameters(Bytes.concat(s, r), null, null));

        var out = new byte[64];
        hk.generateBytes(out, 0, out.length);

        return out;
    }
}
